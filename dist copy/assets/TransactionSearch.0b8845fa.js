import{aK as v,_ as h,r as f,a as m,b as k,n as Y,A as w,f as M,o as D,g as b,j as x,d,t as y,x as p,e as _,ar as $,J as E}from"./index.c1d8041c.js";import{h as i}from"./moment.62d3fb0a.js";const T={data(){return{loading:!1}},props:{url:{type:String,default:"/api/companies/transactions/export/"},form:{type:Object,default:{start:"01-01-2020",end:"01-01-2021"}}},computed:{...v(["getHttpHeader"])},methods:{blobToBase64(c){return new Promise((n,a)=>{const r=new FileReader;r.onloadend=()=>n(r.result),r.readAsDataURL(c)})},tableToExcel(c){this.loading=!0;var n=new XMLHttpRequest;let a=this.url;a+="?",Object.keys(this.form).forEach(e=>{a+=`${e}=${this.form[e]}&`}),console.log(a),n.open("GET",a,!0),n.responseType="blob",Object.keys(this.getHttpHeader).forEach(e=>{n.setRequestHeader(e,this.getHttpHeader[e])});const r=this;n.onload=function(e){var s=e.currentTarget.response,o=e.currentTarget.getResponseHeader("Content-Disposition");o.match(/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/)[1],l(s,"Transaction.xlsx"),r.loading=!1},n.send();function l(e,s){var o=document.createElement("a");o.href=window.URL.createObjectURL(e),o.download=s,o.dispatchEvent(new MouseEvent("click"))}}}},C=M("Export Excel ");function L(c,n,a,r,l,e){const s=f("LoadingIcon");return m(),k("button",{class:"btn btn-primary",onClick:n[0]||(n[0]=o=>e.tableToExcel("Transactions"))},[C,l.loading?(m(),Y(s,{key:0,icon:"oval",color:"white",class:"w-4 h-4 ml-2"})):w("",!0)])}const U=h(T,[["render",L]]),H=["onSubmit"],O={class:"dropdown inline-block","data-placement":"bottom"},R={class:"dropdown-toggle form-control cursor-pointer","aria-expanded":"false"},B={class:"dropdown-menu w-60"},V={class:"dropdown-menu__content box dark:bg-dark-1 p-2"},j={id:"daterangepicker"},A={__name:"TransactionSearch",emits:["submit"],setup(c,{emit:n}){D(()=>{n("submit",{start:a.value,end:r.value})});const a=b(i().subtract(1,"month").format("DD-MM-YYYY")),r=b(i().format("DD-MM-YYYY")),l=x(()=>`${a.value} - ${r.value}`),e=o=>{if(o){const t=o.split(" - ");a.value=t[0],r.value=t[1]}n("submit",{start:a.value,end:r.value})},s=o=>{if(o<7)a.value=i().subtract(o,"day").format("DD-MM-YYYY"),r.value=i().subtract(o,"day").format("DD-MM-YYYY");else switch(o){case 10:a.value=i().startOf("month").format("DD-MM-YYYY"),r.value=i().format("DD-MM-YYYY");break;case 20:a.value=i().subtract(1,"month").startOf("month").format("DD-MM-YYYY"),r.value=i().subtract(1,"month").endOf("month").format("DD-MM-YYYY");break;default:a.value=i().subtract(o,"days").format("DD-MM-YYYY"),r.value=i().format("DD-MM-YYYY")}e()};return(o,t)=>{const g=f("Litepicker");return m(),k("form",{onSubmit:E(e,["prevent"])},[d("div",O,[d("a",R,y(p(l)),1),d("div",B,[d("div",V,[d("button",{"data-dismiss":"dropdown",onClick:t[0]||(t[0]=u=>s(0)),class:"block p-2 transition duration-300 ease-in-out bg-white dark:bg-dark-1 hover:bg-gray-200 dark:hover:bg-dark-2 rounded-md text-left w-full"}," Today "),d("button",{"data-dismiss":"dropdown",onClick:t[1]||(t[1]=u=>s(1)),class:"block p-2 transition duration-300 ease-in-out bg-white dark:bg-dark-1 hover:bg-gray-200 dark:hover:bg-dark-2 rounded-md text-left w-full"}," Yesterday "),d("button",{"data-dismiss":"dropdown",onClick:t[2]||(t[2]=u=>s(7)),class:"block p-2 transition duration-300 ease-in-out bg-white dark:bg-dark-1 hover:bg-gray-200 dark:hover:bg-dark-2 rounded-md text-left w-full"}," Last 7 days "),d("button",{"data-dismiss":"dropdown",onClick:t[3]||(t[3]=u=>s(30)),class:"block p-2 transition duration-300 ease-in-out bg-white dark:bg-dark-1 hover:bg-gray-200 dark:hover:bg-dark-2 rounded-md text-left w-full"}," Last 30 days "),d("button",{"data-dismiss":"dropdown",onClick:t[4]||(t[4]=u=>s(10)),class:"block p-2 transition duration-300 ease-in-out bg-white dark:bg-dark-1 hover:bg-gray-200 dark:hover:bg-dark-2 rounded-md text-left w-full"}," This Month "),d("button",{"data-dismiss":"dropdown",onClick:t[5]||(t[5]=u=>s(20)),class:"block p-2 transition duration-300 ease-in-out bg-white dark:bg-dark-1 hover:bg-gray-200 dark:hover:bg-dark-2 rounded-md text-left w-full"}," Last Month "),d("div",j,[d("div",null,[_(g,{modelValue:p(l),"onUpdate:modelValue":[t[6]||(t[6]=u=>$(l)?l.value=u:null),e],options:{format:"DD-MM-YYYY",autoApply:!1,singleMode:!1,numberOfColumns:2,numberOfMonths:2,showWeekNumbers:!0,dropdowns:{minYear:1990,maxYear:new Date().getFullYear(),months:!0,years:!0}},class:"form-control block p-2 transition duration-300 ease-in-out bg-white dark:bg-dark-1 hover:bg-gray-200 dark:hover:bg-dark-2 rounded-md text-left w-full"},null,8,["modelValue","options"])])])])])])],40,H)}}};export{U as E,A as _};

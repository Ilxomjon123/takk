import{q as B,ac as D,aK as $,X as I,aN as M,aL as N,_ as A,r as i,a as l,b as n,d as s,e as d,G as b,H as _,y as v,t as a,A as u,w as C,F as c,l as E,n as T,J as Y,f as w}from"./index.c1d8041c.js";import{_ as F}from"./DeleteConfirmModal.8e1bb800.js";import{S as j}from"./SimpleImageUpload.74eb2152.js";const m=B(),O=D({data(){return{employee:{phone:"",employee_position:null,cafes:[]},images:{},isLoading:!1,errors:{},cafeList:[],deleteLoading:!1}},computed:{...$(["getEmployeeTypes","getCompanyId"])},props:{form:{type:Object,default:{user:{avatar:"/src/assets/images/default_employee.png"},cafes:[],employee_position:"",phone:""}},isEdit:{type:Boolean,default:!1},dispatcher:{type:String,default:"postEmployeeExist"},isAddExist:{type:Boolean,default:!1}},async created(){var e;this.employee=this.form,this.employee.cafes=(e=this.form.cafes)==null?void 0:e.filter(t=>!I.exports.isUndefined(t)).map(t=>t.id),this.cafeList=await M()},methods:{...N(["fetchCafeList"]),async submit(){var e,t;try{this.isLoading=!0,this.errors={};let r;this.isEdit?r={id:(e=this.employee)==null?void 0:e.id,form:this.employee}:r=this.employee;const L=await this.$store.dispatch(this.dispatcher,r);m.success(),this.$router.push("/dashboard/employees")}catch(r){m.error(),this.errors=(t=r.response)==null?void 0:t.data}finally{this.isLoading=!1}},async deleteEmployee(){var e;try{this.deleteLoading=!0,this.errors={};const t=await this.$store.dispatch("deleteEmployee",(e=this.employee)==null?void 0:e.id);m.success("Record deleted successfully!"),this.$router.push({name:"employees"})}catch(t){m.error("Error while deleting data: "+t.messages)}finally{this.deleteLoading=!1}},getError(e){var t;return(t=this.errors[e])==null?void 0:t[0]}},components:{DeleteConfirmModal:F,SimpleImageUpload:j}}),P={class:"col-span-12 lg:col-span-4 2xl:col-span-3 flex lg:block flex-col-reverse"},G={class:"flex flex-wrap -mx-3 mb-3"},q={class:"w-full px-3 mb-3"},z=s("label",{for:"phone",class:"form-label"},[w(" Phone "),s("span",{class:"text-theme-6"},"*")],-1),H=["disabled"],J=["textContent"],K=["textContent"],R={key:0,class:"w-full px-3 mb-3"},W=s("label",{for:"username",class:"form-label"},"Username",-1),X=["disabled"],Q=["textContent"],Z={key:1,class:"w-full px-3 mb-3"},ee=s("label",{for:"birth-date",class:"form-label"},"Birthday",-1),te={class:"relative mx-auto"},se={class:"absolute rounded-l w-10 h-full flex items-center justify-center bg-gray-100 border text-gray-600 dark:bg-dark-1 dark:border-dark-4"},oe=["textContent"],le={class:"w-full px-3 mb-3"},ae=s("label",{for:"employee.username",class:"form-label"},[w(" Position "),s("span",{class:"text-theme-6"},"*")],-1),ne=s("option",{value:""},"Select position",-1),re=["value"],ie=["textContent"],de={class:"w-full px-3 mb-3"},me=s("label",{class:"form-label"},"Cafes",-1),pe=s("option",{disabled:"",value:""},"Select cafe",-1),ue=["value"],ce=["textContent"],fe={class:"flex justify-end gap-3"};function he(e,t,r,L,ye,ge){var h,y,g;const x=i("SimpleImageUpload"),k=i("CalendarIcon"),V=i("Litepicker"),f=i("TomSelect"),S=i("DeleteConfirmModal"),U=i("SubmitButton");return l(),n(c,null,[s("div",P,[d(x,{title:((h=e.employee.user)==null?void 0:h.avatar)&&"Change photo","image-path":(y=e.employee.user)==null?void 0:y.avatar,onUpdateImageFile:t[0]||(t[0]=o=>e.employee.user.avatar=o)},null,8,["title","image-path"])]),s("form",{onSubmit:t[6]||(t[6]=Y((...o)=>e.submit&&e.submit(...o),["prevent"])),class:"col-span-12 lg:col-span-8 2xl:col-span-9"},[s("div",G,[s("div",q,[z,b(s("input",{disabled:e.isEdit,id:"phone",type:"text",class:v(["form-control",e.getError("phone")!=null?"border-theme-6":"border-gray-300"]),placeholder:"Phone","onUpdate:modelValue":t[1]||(t[1]=o=>e.employee.phone=o)},null,10,H),[[_,e.employee.phone]]),s("div",{class:"text-theme-6",textContent:a(e.getError("phone"))},null,8,J),s("div",{class:"text-theme-6",textContent:a((g=e.errors)==null?void 0:g.detail)},null,8,K)]),e.isAddExist?u("",!0):(l(),n("div",R,[W,b(s("input",{disabled:e.isEdit,id:"username",type:"text",class:v(["form-control",e.getError("username")!=null?"border-theme-6":"border-gray-300"]),placeholder:"Username","onUpdate:modelValue":t[2]||(t[2]=o=>e.employee.user.username=o)},null,10,X),[[_,e.employee.user.username]]),s("div",{class:"text-theme-6",textContent:a(e.getError("username"))},null,8,Q)])),e.isAddExist?u("",!0):(l(),n("div",Z,[ee,s("div",te,[s("div",se,[d(k,{class:"w-4 h-4"})]),d(V,{modelValue:e.employee.user.date_of_birthday,"onUpdate:modelValue":t[3]||(t[3]=o=>e.employee.user.date_of_birthday=o),options:{autoApply:!1,showWeekNumbers:!0,format:"YYYY-MM-DD",dropdowns:{minYear:1990,maxYear:null,months:!0,years:!0}},class:"form-control pl-12"},null,8,["modelValue"])]),s("div",{class:"text-theme-6",textContent:a(e.getError("date_of_birthday"))},null,8,oe)])),s("div",le,[ae,d(f,{class:"w-full",modelValue:e.employee.employee_position,"onUpdate:modelValue":t[4]||(t[4]=o=>e.employee.employee_position=o)},{default:C(()=>[ne,(l(!0),n(c,null,E(e.getEmployeeTypes,(o,p)=>(l(),n("option",{key:p,value:o.value},a(o.name),9,re))),128))]),_:1},8,["modelValue"]),s("div",{class:"text-theme-6",textContent:a(e.getError("employee_position"))},null,8,ie)]),s("div",de,[me,d(f,{modelValue:e.employee.cafes,"onUpdate:modelValue":t[5]||(t[5]=o=>e.employee.cafes=o),options:{placeholder:"Select Cafe"},class:"w-full",multiple:""},{default:C(()=>[pe,(l(!0),n(c,null,E(e.cafeList.results,(o,p)=>(l(),n("option",{key:p,value:o.id},a(o.name),9,ue))),128))]),_:1},8,["modelValue"]),s("div",{class:"text-theme-6",textContent:a(e.getError("cafes"))},null,8,ce)])]),s("div",fe,[e.isEdit?(l(),T(S,{key:0,onOnConfirmedDelete:e.deleteEmployee,isLoading:e.deleteLoading},null,8,["onOnConfirmedDelete","isLoading"])):u("",!0),d(U,{"is-loading":e.isLoading},null,8,["is-loading"])])],32)],64)}const Ce=A(O,[["render",he]]);export{Ce as E};
